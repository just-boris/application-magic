\chapter{Моделирование}
\section{Инструменты моделирования}
Для нахождения позиции оптимальной стыковки волноводов, необходимо смоделировать поле волновода, и вычислить интеграл перекрытия, формула которого приведена в главе \ref{coupling}. Перебирая варианты взаимного расположения полей, необходимо найти максимальное значение этого интеграла.

Перебор всех теоретически возможных вариантов занимает длительное время, поэтому стоит его упростить, предполагая единственный максимум у функции. Для оптимизации поиска экстремумов функции используют методы координатного спуска, градиентного (наискорейшего) спуска и симплекс-метод.\cite{numeric} 

Предполагая, что у искомого распределения значений интеграла перекрытия имеется только один максимум, используем метода градиентного спуска, поскольку в этом случае он позволит достичь результата за меньшее число итераций. \cite{mathews}

Итак, нам нужен инструмент, умеющий считать интегралы, проводить итерации и строить графики. В работе используется язык программирования Python, имеющий все необходимое. Кроме того, использование языка программирования вместо математических интерпретаторов, например MATLAB позволяет получить скомпилированный код, который быстрее исполняется, что особенно важно при переборе вариантов.

Для решения наших задач, в Python подключаются отдельные компоненты:
\begin{itemize}
	\item SciPy - пакет математических функций, используется для интегрирования и содержит реализацию алгоритма градиентного спуска
	\item Mathplotlib - для вывода полученных результатов в виде графиков
\end{itemize}

Кроме того был написан свой компонент, реализующий функцию распределения Гаусса, для повышения производительности программы.

\section{Моделирование поперечного смещения}

При поперечном смещении центр выходного поля смещается относительно входного на расстояние $\Delta x$, как показано на рисунке \ref{transverse_movement}. Для исследования коэффициента передачи была написана программа, вычисляющая значения интеграла перекрытия в пределах $x \in [-20, 20]$.
Для моделирования использовались два случая
\begin{itemize}
	\item Два одинаковых цилиндрических волновода с радиусом моды 4~мкм
	\item Два разных цилиндрических волновода с радиусами моды 4~мкм и 7~мкм соответственно
\end{itemize}

В ходе моделирования, было обнаружено, что только два одинаковых волновода теоретически позволяют достичь стыковки без потерь. Во втором случае, показанном на рисунке \ref{twoCylinders2} максимальное значение составило 0.862 и это значение будет уменьшаться с ростом разницы в размерах волноводов.

\begin{figure}[h!]
		\includegraphics[width=0.5\linewidth]{img/twoCylinders.png}
		\caption{Зависимость коэффициента передачи двух одинаковых волноводов с радиусом моды 4~мкм}
\end{figure}
\begin{figure}[h!]
		\includegraphics[width=0.5\linewidth]{img/twoCylinders2.png}
		\caption{Зависимость коэффициента передачи двух волноводов с радиусами моды 4~мкм и 7~мкм}
		\label{twoCylinders2}
\end{figure}

\newpage
\section{Интерактивная модель}
Для решения основной задачи, то есть поиска точки контакта с максимальным значением коэффициента передачи, была построена отдельная программа.

В ней слева показывается поле в выходном волноводе, а справа - схематическое расположение перекрывающихся полей. Ниже показаны числовые значения рассчитываемых параметров. Изначально программа позиционирует волноводы так, чтобы коэффициент передачи был максимален. Кликами по распределению поля можно виртуально изменять положение выходного волновода относительно входного и изображение будет перестраиваться, показывая новое распределение. Таким образом, можно наблюдать что произойдет при отклонении от точки максимального контакта.

\begin{figure}[h!]
	\includegraphics[width=\linewidth]{img/heatmap.png}
	\caption{Общий вид программы}
\end{figure}